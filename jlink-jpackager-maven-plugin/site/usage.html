<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.8.1 from src/site/apt/usage.apt.vm at 2018-12-19 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>JLink-JPackager Maven Plugin &#x2013; </title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta http-equiv="Content-Language" content="en" />
    
  </head>
  <body class="composite">
    <div id="banner">
<div id="bannerLeft">
<img src="images/AgilhardBannerRight.png"  alt="agilhard.net"/></div>
<div id="bannerRight">
<img src="images/AgilhardBannerRight.png"  alt="agilhard.net"/></div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2018-12-19</span>
          &nbsp;| <span id="projectVersion">Version: 1.0.0-SNAPSHOT</span>
      </div>
      <div class="xright">      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>Overview</h5>
    <ul>
     <li class="none"><a href="index.html" title="Introduction">Introduction</a></li>
     <li class="none"><a href="plugin-info.html" title="Goals">Goals</a></li>
     <li class="none"><strong>Usage</strong></li>
     <li class="none"><a href="http://www.apache.org/licenses/" class="externalLink" title="License">License</a></li>
    </ul>
       <h5>Project Documentation</h5>
    <ul>
     <li class="collapsed"><a href="project-info.html" title="Project Information">Project Information</a></li>
     <li class="collapsed"><a href="project-reports.html" title="Project Reports">Project Reports</a></li>
    </ul>
      <a href="https://github.com/agilhard-oss" title="Agilhard" class="poweredBy">
        <img class="poweredBy"  alt="Agilhard" src="images/AgilhardSignet.png"     title="Agilhard" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<div class="section">
<h2><a name="Usage"></a>Usage</h2>
<div class="section">
<h3><a name="Introduction"></a>Introduction</h3>
<p>The JLink plugin is used to create <a class="externalLink" href="http://openjdk.java.net/jeps/220">Modular Run-Time Images</a> with JDK 9 or an installable package via <a class="externalLink" href="http://openjdk.java.net/jeps/343">jpackage</a> with JDK12</p>
<p>The intended artifacts to be linked together into a Modular Run-Time Image are the <b>jmod</b> and <b>jar</b> files. JMod files can be created by using the <a href="../maven-jmod-plugin/">Maven JMod Plugin</a> and <b>jar</b> files can be created by using the <a href="../maven-jar-plugin/">Maven JAR Plugin</a>.</p></div>
<div class="section">
<h3><a name="Configuration_of_the_JLink-JPackager_Maven_Plugin"></a>Configuration of the JLink-JPackager Maven Plugin</h3>
<p>To use the JLink-JPackager Maven Plugin you have to configure it as an <tt>extensions</tt> which means the configuration in your pom file has to look like this:</p>
<div class="source">
<pre>&lt;project&gt;
  [...]
  &lt;build&gt;
    [...]
    &lt;plugins&gt;
      [...]
      &lt;plugin&gt;
        &lt;groupId&gt;net.agilhard.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;jlink-jpackager-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
        &lt;extensions&gt;true&lt;/extensions&gt;
        &lt;configuration&gt;
          &lt;!-- configuration elements goes here --&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
   [...]
&lt;/project&gt;</pre></div>
<p>The configuration element contains the configuration for the plugin <a class="externalLink" href="https://maven.apache.org/guides/mini/guide-configuring-plugins.html">}like any other Maven plugin</a>. The different elements which can be configured for this plugin can identified by the <a href="./plugin-info.html">goals documentation</a>.</p></div>
<div class="section">
<h3><a name="Requirements"></a>Requirements</h3>
<p>Based on the foundation of the plugin it is required to have at least JDK 9 installed to use the jlink goal and at least JDK12 installed to use the jpackager goal. This means either you have it configured via <b>JAVA_HOME</b> which means to run the whole Maven build with JDK 9/12 or via <b>Toolchains</b>.</p>
<p>Howto configure Maven related to Toolchains can be read in the <a class="externalLink" href="https://maven.apache.org/guides/mini/guide-using-toolchains.html">Toolchains documentation</a>.</p></div>
<div class="section">
<h3><a name="Usage_of_the_JLink-JPackager_Maven_Plugin"></a>Usage of the JLink-JPackager Maven Plugin</h3>
<p>Usually you will use the Maven JLink-JPackager Plugin to create a Run Time Image or an installable Package from one or more modules within a multi module build In other words it is not possible to create a Run Time Image or Package from a single Maven Project within the same single Maven Project. Let us assume you have a multi module structure which contains two modules <b>mod-1</b> and <b>mod-2</b> which you like to put into the resulting Run Time Image.</p>
<p>The parent of the multi module looks similar like this: </p>
<div class="source">
<pre>&lt;project ...&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;parent&gt;
    &lt;groupId&gt;com.corporate.maven&lt;/groupId&gt;
    &lt;artifactId&gt;maven-parent&lt;/artifactId&gt;
    &lt;version&gt;2.3.1&lt;/version&gt;
  &lt;/parent&gt;
  &lt;groupId&gt;com.corporate.project&lt;/groupId&gt;
  &lt;artifactId&gt;parent&lt;/artifactId&gt;
  &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;packaging&gt;pom&lt;/packaging&gt;
   [...]
  &lt;modules&gt;
    &lt;module&gt;mod-1&lt;/module&gt;
    &lt;module&gt;mod-2&lt;/module&gt;
  &lt;/modules&gt;  
   [...]
&lt;/project&gt;</pre></div>
<p>A directory structure of such a project looks like this:</p>
<div class="source">
<pre>.
&#x251c;&#x2500;&#x2500; mod-1
&#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; src
&#x2514;&#x2500;&#x2500; mod-2
 &#xa0;&#xa0; &#x2514;&#x2500;&#x2500; src</pre></div>
<p>The <b>mod-1</b> module looks similar like this:</p>
<div class="source">
<pre>&lt;project ...&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;parent&gt;
    &lt;groupId&gt;com.corporate.project&lt;/groupId&gt;
    &lt;artifactId&gt;parent&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;/parent&gt;
  &lt;artifactId&gt;mod-1&lt;/artifactId&gt;
   [...]
&lt;/project&gt;</pre></div>
<p>The <b>mod-2</b> module looks similar like this:</p>
<div class="source">
<pre>&lt;project ...&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;parent&gt;
    &lt;groupId&gt;com.corporate.project&lt;/groupId&gt;
    &lt;artifactId&gt;parent&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;/parent&gt;
  &lt;artifactId&gt;mod-2&lt;/artifactId&gt;
   [...]
&lt;/project&gt;</pre></div>
<p>If you like to create a Java Run Time Image of your modules you have to create a separate module <b>mod-jlink</b> which contains the configuration to create the Run Time Image which looks similar like this:</p>
<div class="source">
<pre>&lt;project ...&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;parent&gt;
    &lt;groupId&gt;com.corporate.project&lt;/groupId&gt;
    &lt;artifactId&gt;parent&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;/parent&gt;
  &lt;packaging&gt;jlink&lt;/packaging&gt;
  &lt;artifactId&gt;mod-jlink&lt;/artifactId&gt;
   [...]
&lt;/project&gt;</pre></div>
<p>The directory structure now looks like this:</p>
<div class="source">
<pre>.
&#x251c;&#x2500;&#x2500; mod-1
&#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; src
&#x251c;&#x2500;&#x2500; mod-2
&#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; src
&#x2514;&#x2500;&#x2500; mod-jlink
    &#x2514;&#x2500;&#x2500; src</pre></div>
<p>Or if you like to create a installable package of your modules you have to create a separate module <b>mod-jpackager</b> which contains the configuration to create the Run Time Image which looks similar like this:</p>
<div class="source">
<pre>&lt;project ...&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;parent&gt;
    &lt;groupId&gt;com.corporate.project&lt;/groupId&gt;
    &lt;artifactId&gt;parent&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;/parent&gt;
  &lt;packaging&gt;jpackager&lt;/packaging&gt;
  &lt;artifactId&gt;mod-jlink&lt;/artifactId&gt;
   [...]
&lt;/project&gt;</pre></div>
<p>The directory structure than looks like this:</p>
<div class="source">
<pre>.
&#x251c;&#x2500;&#x2500; mod-1
&#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; src
&#x251c;&#x2500;&#x2500; mod-2
&#x2502;&#xa0;&#xa0; &#x2514;&#x2500;&#x2500; src
&#x2514;&#x2500;&#x2500; mod-jpackager
    &#x2514;&#x2500;&#x2500; src</pre></div>
<p>Before you can do this you have to add the configuration to the parent like shown in <a href="#Configuration_of_the_JLink-JPackager_Maven_Plugin">Configuration of the JLink-JPackager Maven Plugin</a>.</p>
<p>Now you need to define which modules should be linked into the resulting Java Run Time Image which simply can be done by defining the modules as dependencies to your <b>mod-jlink</b> or <b>mod-jpackager</b> module like this:</p>
<div class="source">
<pre>&lt;project ...&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;parent&gt;
    &lt;groupId&gt;com.corporate.project&lt;/groupId&gt;
    &lt;artifactId&gt;parent&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;/parent&gt;
  &lt;packaging&gt;jlink&lt;/packaging&gt;
  &lt;artifactId&gt;mod-jlink&lt;/artifactId&gt;
 &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.corporate.project&lt;/groupId&gt;
      &lt;artifactId&gt;mod-1&lt;/artifactId&gt;
      &lt;version&gt;${project.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.corporate.project&lt;/groupId&gt;
      &lt;artifactId&gt;mod-2&lt;/artifactId&gt;
      &lt;version&gt;${project.version}&lt;/version&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;  
   [...]
&lt;/project&gt;</pre></div>
<p>When you use the <b>jpackager</b> goal you also have to at least specify some minimal configuration with a <b>module</b> element specifying the main module and the main class like this:</p>
<div class="source">
<pre>&lt;project ...&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;parent&gt;
    &lt;groupId&gt;com.corporate.project&lt;/groupId&gt;
    &lt;artifactId&gt;parent&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
  &lt;/parent&gt;
  &lt;packaging&gt;jpackager&lt;/packaging&gt;
  &lt;artifactId&gt;mod-jpackager&lt;/artifactId&gt;

  &lt;build&gt;
    &lt;plugins&gt;

      &lt;plugin&gt;
        &lt;groupId&gt;net.agilhard.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;jlink-jpackager-maven-plugin&lt;/artifactId&gt;
        &lt;extensions&gt;true&lt;/extensions&gt;
        &lt;configuration&gt;
          &lt;verbose&gt;true&lt;/verbose&gt;
          &lt;module&gt;com.corporate.project.mod-1/MainClass&lt;/module&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;

    &lt;/plugins&gt;

 &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.corporate.project&lt;/groupId&gt;
      &lt;artifactId&gt;mod-1&lt;/artifactId&gt;
      &lt;version&gt;${project.version}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;com.corporate.project&lt;/groupId&gt;
      &lt;artifactId&gt;mod-2&lt;/artifactId&gt;
      &lt;version&gt;${project.version}&lt;/version&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;  
   [...]
&lt;/project&gt;</pre></div>
<p>After you have added the appropriate configuration you can simply create the Java Run Time Image or Installable Package by calling from the root of your multi module project like this:</p>
<div class="source">
<pre>mvn clean package</pre></div>
<p>There are some output lines similar like this:</p>
<div class="source">
<pre>[INFO]
[INFO] --- jlink-jpacker-plugin:1.0.0-SNAPSHOT:jlink (default-jlink) @ mod-jlink ---
[INFO] Toolchain in jlink-jpackager-maven-plugin: jlink [ /.../jdk1.9.0_ea+181.jdk/Contents/Home/bin/jlink ]
[INFO] The following dependencies will be linked into the runtime image:
[INFO]  -&gt; module: com.soebes.nine.one.jar ( /.../mod-1/target/mod-1-1.0-SNAPSHOT.jar )
[INFO]  -&gt; module: com.soebes.nine.two.jar ( /.../mod-2/target/mod-2-1.0-SNAPSHOT.jar )
[INFO] Building zip: /.../mod-jlink/target/mod-jlink-1.0-SNAPSHOT.zip
[INFO]</pre></div>
<p>If you like to install the resulting Java Run Time Image files into your local cache you can achieve this by using:</p>
<div class="source">
<pre>mvn clean install</pre></div>
<p>or if you like to deploy the resulting artifacts to a remote repository you have to use:</p>
<div class="source">
<pre>mvn clean deploy</pre></div>
<p>At the moment the resulting Java Run Time Image is packaged into a <b>zip</b> archive which used to transport the whole structure which is created by <b>jlink</b> to a repository.</p>
<p>The resulting <a class="externalLink" href="https://docs.oracle.com/javase/9/install/installed-directory-structure-jdk-and-jre.htm">Java Run Time Image directory structure</a> looks like this:</p>
<div class="source">
<pre>jlink/
&#x251c;&#x2500;&#x2500; bin
&#x251c;&#x2500;&#x2500; conf
&#x251c;&#x2500;&#x2500; include
&#x251c;&#x2500;&#x2500; legal
&#x251c;&#x2500;&#x2500; lib
&#x2514;&#x2500;&#x2500; release</pre></div>
<p>Packages build with the <b>jpackager</b> goal are deployed into the repository with a maven classifier based on the package type and the extension for the package format, eg. .rpm .msi </p></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2018.All rights reserved.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
